"use strict";(()=>{var Ml=Object.create,Mn=Object.defineProperty,Ol=Object.getOwnPropertyDescriptor,Nl=Object.getOwnPropertyNames,Fl=Object.getPrototypeOf,Ul=Object.prototype.hasOwnProperty,On=function(r,e){return function(){return r&&(e=r(r=0)),e}},Ae=function(r,e){return function(){return e||r((e={exports:{}}).exports,e),e.exports}},Bl=function(r,e,t,i){if(e&&typeof e=="object"||typeof e=="function")for(var s=Nl(e),n=0,a=s.length,o;n<a;n++)o=s[n],!Ul.call(r,o)&&o!==t&&Mn(r,o,{get:function(l){return e[l]}.bind(null,o),enumerable:!(i=Ol(e,o))||i.enumerable});return r},Oe=function(r,e,t){return t=r!=null?Ml(Fl(r)):{},Bl(e||!r||!r.__esModule?Mn(t,"default",{value:r,enumerable:!0}):t,r)},Ge=Ae(function(r,e){var t;typeof window!="undefined"?t=window:typeof global!="undefined"?t=global:typeof self!="undefined"?t=self:t={},e.exports=t});function ut(r,e){return e!=null&&typeof Symbol!="undefined"&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](r):ut(r,e)}var dt=On(function(){dt()});function _r(r){"@swc/helpers - typeof";return r&&typeof Symbol!="undefined"&&r.constructor===Symbol?"symbol":typeof r}var Sr=On(function(){}),Nn=Ae(function(r,e){var t=Array.prototype.slice;e.exports=i;function i(s,n){for(("length"in s)||(s=[s]),s=t.call(s);s.length;){var a=s.shift(),o=n(a);if(o)return o;a.childNodes&&a.childNodes.length&&(s=t.call(a.childNodes).concat(s))}}}),$l=Ae(function(r,e){dt(),e.exports=t;function t(i,s){if(!ut(this,t))return new t(i,s);this.data=i,this.nodeValue=i,this.length=i.length,this.ownerDocument=s||null}t.prototype.nodeType=8,t.prototype.nodeName="#comment",t.prototype.toString=function(){return"[object Comment]"}}),Gl=Ae(function(r,e){dt(),e.exports=t;function t(i,s){if(!ut(this,t))return new t(i);this.data=i||"",this.length=this.data.length,this.ownerDocument=s||null}t.prototype.type="DOMTextNode",t.prototype.nodeType=3,t.prototype.nodeName="#text",t.prototype.toString=function(){return this.data},t.prototype.replaceData=function(i,s,n){var a=this.data,o=a.substring(0,i),l=a.substring(i+s,a.length);this.data=o+n+l,this.length=this.data.length}}),Fn=Ae(function(r,e){e.exports=t;function t(i){var s=this,n=i.type;i.target||(i.target=s),s.listeners||(s.listeners={});var a=s.listeners[n];if(a)return a.forEach(function(o){i.currentTarget=s,typeof o=="function"?o(i):o.handleEvent(i)});s.parentNode&&s.parentNode.dispatchEvent(i)}}),Un=Ae(function(r,e){e.exports=t;function t(i,s){var n=this;n.listeners||(n.listeners={}),n.listeners[i]||(n.listeners[i]=[]),n.listeners[i].indexOf(s)===-1&&n.listeners[i].push(s)}}),Bn=Ae(function(r,e){e.exports=t;function t(i,s){var n=this;if(n.listeners&&n.listeners[i]){var a=n.listeners[i],o=a.indexOf(s);o!==-1&&a.splice(o,1)}}}),Hl=Ae(function(r,e){Sr(),e.exports=i;var t=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function i(h){switch(h.nodeType){case 3:return u(h.data);case 8:return"<!--"+h.data+"-->";default:return s(h)}}function s(h){var f=[],m=h.tagName;return h.namespaceURI==="http://www.w3.org/1999/xhtml"&&(m=m.toLowerCase()),f.push("<"+m+c(h)+o(h)),t.indexOf(m)>-1?f.push(" />"):(f.push(">"),h.childNodes.length?f.push.apply(f,h.childNodes.map(i)):h.textContent||h.innerText?f.push(u(h.textContent||h.innerText)):h.innerHTML&&f.push(h.innerHTML),f.push("</"+m+">")),f.join("")}function n(h,f){var m=_r(h[f]);return f==="style"&&Object.keys(h.style).length>0?!0:h.hasOwnProperty(f)&&(m==="string"||m==="boolean"||m==="number")&&f!=="nodeName"&&f!=="className"&&f!=="tagName"&&f!=="textContent"&&f!=="innerText"&&f!=="namespaceURI"&&f!=="innerHTML"}function a(h){if(typeof h=="string")return h;var f="";return Object.keys(h).forEach(function(m){var g=h[m];m=m.replace(/[A-Z]/g,function(p){return"-"+p.toLowerCase()}),f+=m+":"+g+";"}),f}function o(h){var f=h.dataset,m=[];for(var g in f)m.push({name:"data-"+g,value:f[g]});return m.length?l(m):""}function l(h){var f=[];return h.forEach(function(m){var g=m.name,p=m.value;g==="style"&&(p=a(p)),f.push(g+'="'+d(p)+'"')}),f.length?" "+f.join(" "):""}function c(h){var f=[];for(var m in h)n(h,m)&&f.push({name:m,value:h[m]});for(var g in h._attributes)for(var p in h._attributes[g]){var T=h._attributes[g][p],E=(T.prefix?T.prefix+":":"")+p;f.push({name:E,value:T.value})}return h.className&&f.push({name:"class",value:h.className}),f.length?l(f):""}function u(h){var f="";return typeof h=="string"?f=h:h&&(f=h.toString()),f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(h){return u(h).replace(/"/g,"&quot;")}}),$n=Ae(function(r,e){dt();var t=Nn(),i=Fn(),s=Un(),n=Bn(),a=Hl(),o="http://www.w3.org/1999/xhtml";e.exports=l;function l(c,u,d){if(!ut(this,l))return new l(c);var h=d===void 0?o:d||null;this.tagName=h===o?String(c).toUpperCase():c,this.nodeName=this.tagName,this.className="",this.dataset={},this.childNodes=[],this.parentNode=null,this.style={},this.ownerDocument=u||null,this.namespaceURI=h,this._attributes={},this.tagName==="INPUT"&&(this.type="text")}l.prototype.type="DOMElement",l.prototype.nodeType=1,l.prototype.appendChild=function(c){return c.parentNode&&c.parentNode.removeChild(c),this.childNodes.push(c),c.parentNode=this,c},l.prototype.replaceChild=function(c,u){c.parentNode&&c.parentNode.removeChild(c);var d=this.childNodes.indexOf(u);return u.parentNode=null,this.childNodes[d]=c,c.parentNode=this,u},l.prototype.removeChild=function(c){var u=this.childNodes.indexOf(c);return this.childNodes.splice(u,1),c.parentNode=null,c},l.prototype.insertBefore=function(c,u){c.parentNode&&c.parentNode.removeChild(c);var d=u==null?-1:this.childNodes.indexOf(u);return d>-1?this.childNodes.splice(d,0,c):this.childNodes.push(c),c.parentNode=this,c},l.prototype.setAttributeNS=function(c,u,d){var h=null,f=u,m=u.indexOf(":");if(m>-1&&(h=u.substr(0,m),f=u.substr(m+1)),this.tagName==="INPUT"&&u==="type")this.type=d;else{var g=this._attributes[c]||(this._attributes[c]={});g[f]={value:d,prefix:h}}},l.prototype.getAttributeNS=function(c,u){var d=this._attributes[c],h=d&&d[u]&&d[u].value;return this.tagName==="INPUT"&&u==="type"?this.type:typeof h!="string"?null:h},l.prototype.removeAttributeNS=function(c,u){var d=this._attributes[c];d&&delete d[u]},l.prototype.hasAttributeNS=function(c,u){var d=this._attributes[c];return!!d&&u in d},l.prototype.setAttribute=function(c,u){return this.setAttributeNS(null,c,u)},l.prototype.getAttribute=function(c){return this.getAttributeNS(null,c)},l.prototype.removeAttribute=function(c){return this.removeAttributeNS(null,c)},l.prototype.hasAttribute=function(c){return this.hasAttributeNS(null,c)},l.prototype.removeEventListener=n,l.prototype.addEventListener=s,l.prototype.dispatchEvent=i,l.prototype.focus=function(){},l.prototype.toString=function(){return a(this)},l.prototype.getElementsByClassName=function(c){var u=c.split(" "),d=[];return t(this,function(h){if(h.nodeType===1){var f=h.className||"",m=f.split(" ");u.every(function(g){return m.indexOf(g)!==-1})&&d.push(h)}}),d},l.prototype.getElementsByTagName=function(c){c=c.toLowerCase();var u=[];return t(this.childNodes,function(d){d.nodeType===1&&(c==="*"||d.tagName.toLowerCase()===c)&&u.push(d)}),u},l.prototype.contains=function(c){return t(this,function(u){return c===u})||!1}}),Kl=Ae(function(r,e){dt();var t=$n();e.exports=i;function i(s){if(!ut(this,i))return new i;this.childNodes=[],this.parentNode=null,this.ownerDocument=s||null}i.prototype.type="DocumentFragment",i.prototype.nodeType=11,i.prototype.nodeName="#document-fragment",i.prototype.appendChild=t.prototype.appendChild,i.prototype.replaceChild=t.prototype.replaceChild,i.prototype.removeChild=t.prototype.removeChild,i.prototype.toString=function(){return this.childNodes.map(function(s){return String(s)}).join("")}}),Vl=Ae(function(r,e){e.exports=t;function t(i){}t.prototype.initEvent=function(i,s,n){this.type=i,this.bubbles=s,this.cancelable=n},t.prototype.preventDefault=function(){}}),ql=Ae(function(r,e){dt();var t=Nn(),i=$l(),s=Gl(),n=$n(),a=Kl(),o=Vl(),l=Fn(),c=Un(),u=Bn();e.exports=d;function d(){if(!ut(this,d))return new d;this.head=this.createElement("head"),this.body=this.createElement("body"),this.documentElement=this.createElement("html"),this.documentElement.appendChild(this.head),this.documentElement.appendChild(this.body),this.childNodes=[this.documentElement],this.nodeType=9}var h=d.prototype;h.createTextNode=function(f){return new s(f,this)},h.createElementNS=function(f,m){var g=f===null?null:String(f);return new n(m,this,g)},h.createElement=function(f){return new n(f,this)},h.createDocumentFragment=function(){return new a(this)},h.createEvent=function(f){return new o(f)},h.createComment=function(f){return new i(f,this)},h.getElementById=function(f){f=String(f);var m=t(this.childNodes,function(g){if(String(g.id)===f)return g});return m||null},h.getElementsByClassName=n.prototype.getElementsByClassName,h.getElementsByTagName=n.prototype.getElementsByTagName,h.contains=n.prototype.contains,h.removeEventListener=u,h.addEventListener=c,h.dispatchEvent=l}),Wl=Ae(function(r,e){var t=ql();e.exports=new t}),Yl=Ae(function(r,e){var t=typeof global!="undefined"?global:typeof window!="undefined"?window:{},i=Wl(),s;typeof document!="undefined"?s=document:(s=t["__GLOBAL_DOCUMENT_CACHE@4"],s||(s=t["__GLOBAL_DOCUMENT_CACHE@4"]=i)),e.exports=s});function jl(r){if(Array.isArray(r))return r}function zl(r,e){var t=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var i=[],s=!0,n=!1,a,o;try{for(t=t.call(r);!(s=(a=t.next()).done)&&(i.push(a.value),!(e&&i.length===e));s=!0);}catch(l){n=!0,o=l}finally{try{!s&&t.return!=null&&t.return()}finally{if(n)throw o}}return i}}function Xl(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yr(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=r[t];return i}function Gn(r,e){if(r){if(typeof r=="string")return yr(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(t);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return yr(r,e)}}function Xe(r,e){return jl(r)||zl(r,e)||Gn(r,e)||Xl()}var Mt=Oe(Ge()),Nt=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=Math.random()*16|0,t=r==="x"?e:e&3|8;return t.toString(16)})},Hn=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)},ot=function(r){if(r&&typeof r.nodeName!="undefined")return r.muxId||(r.muxId=Hn()),r.muxId;var e;try{e=document.querySelector(r)}catch{}return e&&!e.muxId&&(e.muxId=r),(e==null?void 0:e.muxId)||r},Tr=function(r){var e;r&&typeof r.nodeName!="undefined"?(e=r,r=ot(e)):e=document.querySelector(r);var t=e&&e.nodeName?e.nodeName.toLowerCase():"";return[e,r,t]};function Ql(r){if(Array.isArray(r))return yr(r)}function Jl(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Zl(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $e(r){return Ql(r)||Jl(r)||Gn(r)||Zl()}var lt={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},ec=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,t,i,s,n,a,o=r?[console,r]:[console],l=(t=console.trace).bind.apply(t,$e(o)),c=(i=console.info).bind.apply(i,$e(o)),u=(s=console.debug).bind.apply(s,$e(o)),d=(n=console.warn).bind.apply(n,$e(o)),h=(a=console.error).bind.apply(a,$e(o)),f=e;return{trace:function(){for(var m=arguments.length,g=new Array(m),p=0;p<m;p++)g[p]=arguments[p];if(!(f>lt.TRACE))return l.apply(void 0,$e(g))},debug:function(){for(var m=arguments.length,g=new Array(m),p=0;p<m;p++)g[p]=arguments[p];if(!(f>lt.DEBUG))return u.apply(void 0,$e(g))},info:function(){for(var m=arguments.length,g=new Array(m),p=0;p<m;p++)g[p]=arguments[p];if(!(f>lt.INFO))return c.apply(void 0,$e(g))},warn:function(){for(var m=arguments.length,g=new Array(m),p=0;p<m;p++)g[p]=arguments[p];if(!(f>lt.WARN))return d.apply(void 0,$e(g))},error:function(){for(var m=arguments.length,g=new Array(m),p=0;p<m;p++)g[p]=arguments[p];if(!(f>lt.ERROR))return h.apply(void 0,$e(g))},get level(){return f},set level(m){m!==this.level&&(f=m!=null?m:e)}}},oe=ec("[mux]"),hr=Oe(Ge());function vr(){var r=hr.default.doNotTrack||hr.default.navigator&&hr.default.navigator.doNotTrack;return r==="1"}var tc=Oe(Ge()),ic={now:function(){var r=tc.default.performance,e=r&&r.timing,t=e&&e.navigationStart,i=typeof t=="number"&&typeof r.now=="function"?t+r.now():Date.now();return Math.round(i)}},me=ic;function W(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}dt();function ye(r,e){if(!ut(r,e))throw new TypeError("Cannot call a class as a function")}function Ln(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function He(r,e,t){return e&&Ln(r.prototype,e),t&&Ln(r,t),r}function C(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Er(r,e){return Er=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t},Er(r,e)}function rc(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&Er(r,e)}function si(r){return si=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},si(r)}function sc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}Sr();function nc(r,e){return e&&(_r(e)==="object"||typeof e=="function")?e:W(r)}function ac(r){var e=sc();return function(){var t=si(r),i;if(e){var s=si(this).constructor;i=Reflect.construct(t,arguments,s)}else i=t.apply(this,arguments);return nc(this,i)}}var Me=function(r){return Ft(r)[0]},Ft=function(r){if(typeof r!="string"||r==="")return["localhost"];var e=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,t=r.match(e)||[],i=t[4],s;return i&&(s=(i.match(/[^\.]+\.[^\.]+$/)||[])[0]),[i,s]},fr=Oe(Ge()),oc={exists:function(){var r=fr.default.performance,e=r&&r.timing;return e!==void 0},domContentLoadedEventEnd:function(){var r=fr.default.performance,e=r&&r.timing;return e&&e.domContentLoadedEventEnd},navigationStart:function(){var r=fr.default.performance,e=r&&r.timing;return e&&e.navigationStart}},ni=oc;function de(r,e,t){t=t===void 0?1:t,r[e]=r[e]||0,r[e]+=t}function ai(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),i.forEach(function(s){C(r,s,t[s])})}return r}function lc(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,i)}return t}function br(r,e){return e=e!=null?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):lc(Object(e)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}),r}var cc=["x-cdn","content-type"],Kn=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],uc=cc.concat(Kn);function Ar(r){r=r||"";var e={},t=r.trim().split(/[\r\n]+/);return t.forEach(function(i){if(i){var s=i.split(": "),n=s.shift();n&&(uc.indexOf(n.toLowerCase())>=0||n.toLowerCase().indexOf("x-litix-")===0)&&(e[n]=s.join(": "))}}),e}function oi(r){if(r){var e=Kn.find(function(t){return r[t]!==void 0});return e?r[e]:void 0}}var dc=function(r){var e={};for(var t in r){var i=r[t],s=i["DATA-ID"].search("io.litix.data.");if(s!==-1){var n=i["DATA-ID"].replace("io.litix.data.","");e[n]=i.VALUE}}return e},Vn=dc,ri=function(r){if(!r)return{};var e=ni.navigationStart(),t=r.loading,i=t?t.start:r.trequest,s=t?t.first:r.tfirst,n=t?t.end:r.tload;return{bytesLoaded:r.total,requestStart:Math.round(e+i),responseStart:Math.round(e+s),responseEnd:Math.round(e+n)}},Ct=function(r){if(!(!r||typeof r.getAllResponseHeaders!="function"))return Ar(r.getAllResponseHeaders())},hc=function(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0,n=r.log,a=r.utils.secondsToMs,o=function(T){var E=parseInt(s.version),v;return E===1&&T.programDateTime!==null&&(v=T.programDateTime),E===0&&T.pdt!==null&&(v=T.pdt),v};if(!ni.exists()){n.warn("performance timing not supported. Not tracking HLS.js.");return}var l=function(T,E){return r.emit(e,T,E)},c=function(T,E){var v=E.levels,x=E.audioTracks,_=E.url,A=E.stats,S=E.networkDetails,D=E.sessionData,k={},L={};v.forEach(function(U,j){k[j]={width:U.width,height:U.height,bitrate:U.bitrate,attrs:U.attrs}}),x.forEach(function(U,j){L[j]={name:U.name,language:U.lang,bitrate:U.bitrate}});var I=ri(A),P=I.bytesLoaded,M=I.requestStart,V=I.responseStart,K=I.responseEnd;l("requestcompleted",br(ai({},Vn(D)),{request_event_type:T,request_bytes_loaded:P,request_start:M,request_response_start:V,request_response_end:K,request_type:"manifest",request_hostname:Me(_),request_response_headers:Ct(S),request_rendition_lists:{media:k,audio:L,video:{}}}))};t.on(s.Events.MANIFEST_LOADED,c);var u=function(T,E){var v=E.details,x=E.level,_=E.networkDetails,A=E.stats,S=ri(A),D=S.bytesLoaded,k=S.requestStart,L=S.responseStart,I=S.responseEnd,P=v.fragments[v.fragments.length-1],M=o(P)+a(P.duration);l("requestcompleted",{request_event_type:T,request_bytes_loaded:D,request_start:k,request_response_start:L,request_response_end:I,request_current_level:x,request_type:"manifest",request_hostname:Me(v.url),request_response_headers:Ct(_),video_holdback:v.holdBack&&a(v.holdBack),video_part_holdback:v.partHoldBack&&a(v.partHoldBack),video_part_target_duration:v.partTarget&&a(v.partTarget),video_target_duration:v.targetduration&&a(v.targetduration),video_source_is_live:v.live,player_manifest_newest_program_time:isNaN(M)?void 0:M})};t.on(s.Events.LEVEL_LOADED,u);var d=function(T,E){var v=E.details,x=E.networkDetails,_=E.stats,A=ri(_),S=A.bytesLoaded,D=A.requestStart,k=A.responseStart,L=A.responseEnd;l("requestcompleted",{request_event_type:T,request_bytes_loaded:S,request_start:D,request_response_start:k,request_response_end:L,request_type:"manifest",request_hostname:Me(v.url),request_response_headers:Ct(x)})};t.on(s.Events.AUDIO_TRACK_LOADED,d);var h=function(T,E){var v=E.stats,x=E.networkDetails,_=E.frag;v=v||_.stats;var A=ri(v),S=A.bytesLoaded,D=A.requestStart,k=A.responseStart,L=A.responseEnd,I=x?Ct(x):void 0,P={request_event_type:T,request_bytes_loaded:S,request_start:D,request_response_start:k,request_response_end:L,request_hostname:x?Me(x.responseURL):void 0,request_id:I?oi(I):void 0,request_response_headers:I,request_media_duration:_.duration,request_url:x==null?void 0:x.responseURL};_.type==="main"?(P.request_type="media",P.request_current_level=_.level,P.request_video_width=(t.levels[_.level]||{}).width,P.request_video_height=(t.levels[_.level]||{}).height,P.request_labeled_bitrate=(t.levels[_.level]||{}).bitrate):P.request_type=_.type,l("requestcompleted",P)};t.on(s.Events.FRAG_LOADED,h);var f=function(T,E){var v=E.frag,x=v.start,_=o(v),A={currentFragmentPDT:_,currentFragmentStart:a(x)};l("fragmentchange",A)};t.on(s.Events.FRAG_CHANGED,f);var m=function(T,E){var v=E.type,x=E.details,_=E.response,A=E.fatal,S=E.frag,D=E.networkDetails,k=(S==null?void 0:S.url)||E.url||"",L=D?Ct(D):void 0;if((x===s.ErrorDetails.MANIFEST_LOAD_ERROR||x===s.ErrorDetails.MANIFEST_LOAD_TIMEOUT||x===s.ErrorDetails.FRAG_LOAD_ERROR||x===s.ErrorDetails.FRAG_LOAD_TIMEOUT||x===s.ErrorDetails.LEVEL_LOAD_ERROR||x===s.ErrorDetails.LEVEL_LOAD_TIMEOUT||x===s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||x===s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT||x===s.ErrorDetails.SUBTITLE_LOAD_ERROR||x===s.ErrorDetails.SUBTITLE_LOAD_TIMEOUT||x===s.ErrorDetails.KEY_LOAD_ERROR||x===s.ErrorDetails.KEY_LOAD_TIMEOUT)&&l("requestfailed",{request_error:x,request_url:k,request_hostname:Me(k),request_id:L?oi(L):void 0,request_type:x===s.ErrorDetails.FRAG_LOAD_ERROR||x===s.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":x===s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||x===s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":x===s.ErrorDetails.SUBTITLE_LOAD_ERROR||x===s.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":x===s.ErrorDetails.KEY_LOAD_ERROR||x===s.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:_==null?void 0:_.code,request_error_text:_==null?void 0:_.text}),A){var I,P="".concat(k?"url: ".concat(k,`
`):"")+"".concat(_&&(_.code||_.text)?"response: ".concat(_.code,", ").concat(_.text,`
`):"")+"".concat(E.reason?"failure reason: ".concat(E.reason,`
`):"")+"".concat(E.level?"level: ".concat(E.level,`
`):"")+"".concat(E.parent?"parent stream controller: ".concat(E.parent,`
`):"")+"".concat(E.buffer?"buffer length: ".concat(E.buffer,`
`):"")+"".concat(E.error?"error: ".concat(E.error,`
`):"")+"".concat(E.event?"event: ".concat(E.event,`
`):"")+"".concat(E.err?"error message: ".concat((I=E.err)===null||I===void 0?void 0:I.message,`
`):"");l("error",{player_error_code:v,player_error_message:x,player_error_context:P})}};t.on(s.Events.ERROR,m);var g=function(T,E){var v=E.frag,x=v&&v._url||"";l("requestcanceled",{request_event_type:T,request_url:x,request_type:"media",request_hostname:Me(x)})};t.on(s.Events.FRAG_LOAD_EMERGENCY_ABORTED,g);var p=function(T,E){var v=E.level,x=t.levels[v];if(x&&x.attrs&&x.attrs.BANDWIDTH){var _=x.attrs.BANDWIDTH,A,S=parseFloat(x.attrs["FRAME-RATE"]);isNaN(S)||(A=S),_?l("renditionchange",{video_source_fps:A,video_source_bitrate:_,video_source_width:x.width,video_source_height:x.height,video_source_rendition_name:x.name,video_source_codec:x==null?void 0:x.videoCodec}):n.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};t.on(s.Events.LEVEL_SWITCHED,p),t._stopMuxMonitor=function(){t.off(s.Events.MANIFEST_LOADED,c),t.off(s.Events.LEVEL_LOADED,u),t.off(s.Events.AUDIO_TRACK_LOADED,d),t.off(s.Events.FRAG_LOADED,h),t.off(s.Events.FRAG_CHANGED,f),t.off(s.Events.ERROR,m),t.off(s.Events.FRAG_LOAD_EMERGENCY_ABORTED,g),t.off(s.Events.LEVEL_SWITCHED,p),t.off(s.Events.DESTROYING,t._stopMuxMonitor),delete t._stopMuxMonitor},t.on(s.Events.DESTROYING,t._stopMuxMonitor)},fc=function(r){r&&typeof r._stopMuxMonitor=="function"&&r._stopMuxMonitor()},Dn=function(r,e){if(!r||!r.requestEndDate)return{};var t=Me(r.url),i=r.url,s=r.bytesLoaded,n=new Date(r.requestStartDate).getTime(),a=new Date(r.firstByteDate).getTime(),o=new Date(r.requestEndDate).getTime(),l=isNaN(r.duration)?0:r.duration,c=typeof e.getMetricsFor=="function"?e.getMetricsFor(r.mediaType).HttpList:e.getDashMetrics().getHttpRequests(r.mediaType),u;c.length>0&&(u=Ar(c[c.length-1]._responseHeaders||""));var d=u?oi(u):void 0;return{requestStart:n,requestResponseStart:a,requestResponseEnd:o,requestBytesLoaded:s,requestResponseHeaders:u,requestMediaDuration:l,requestHostname:t,requestUrl:i,requestId:d}},mc=function(r,e){var t=e.getQualityFor(r),i=e.getCurrentTrackFor(r).bitrateList;return i?{currentLevel:t,renditionWidth:i[t].width||null,renditionHeight:i[t].height||null,renditionBitrate:i[t].bandwidth}:{}},gc=function(r){var e;return(e=r.match(/.*codecs\*?="(.*)"/))===null||e===void 0?void 0:e[1]},pc=function(r){try{var e,t,i=(t=r.getVersion)===null||t===void 0||(e=t.call(r))===null||e===void 0?void 0:e.split(".").map(function(s){return parseInt(s)})[0];return i}catch{return!1}},yc=function(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=r.log;if(!t||!t.on){s.warn("Invalid dash.js player reference. Monitoring blocked.");return}var n=pc(t),a=function(v,x){return r.emit(e,v,x)},o=function(v){var x=v.type,_=v.data,A=(_||{}).url;a("requestcompleted",{request_event_type:x,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:Me(A),request_url:A})};t.on("manifestLoaded",o);var l={},c=function(v){if(typeof v.getRequests!="function")return null;var x=v.getRequests({state:"executed"});return x.length===0?null:x[x.length-1]},u=function(v){var x=v.type,_=v.fragmentModel,A=v.chunk,S=c(_);d({type:x,request:S,chunk:A})},d=function(v){var x=v.type,_=v.chunk,A=v.request,S=(_||{}).mediaInfo,D=S||{},k=D.type,L=D.bitrateList;L=L||[];var I={};L.forEach(function(z,q){I[q]={},I[q].width=z.width,I[q].height=z.height,I[q].bitrate=z.bandwidth,I[q].attrs={}}),k==="video"?l.video=I:k==="audio"?l.audio=I:l.media=I;var P=Dn(A,t),M=P.requestStart,V=P.requestResponseStart,K=P.requestResponseEnd,U=P.requestResponseHeaders,j=P.requestMediaDuration,J=P.requestHostname,F=P.requestUrl,O=P.requestId;a("requestcompleted",{request_event_type:x,request_start:M,request_response_start:V,request_response_end:K,request_bytes_loaded:-1,request_type:k+"_init",request_response_headers:U,request_hostname:J,request_id:O,request_url:F,request_media_duration:j,request_rendition_lists:l})};n>=4?t.on("initFragmentLoaded",d):t.on("initFragmentLoaded",u);var h=function(v){var x=v.type,_=v.fragmentModel,A=v.chunk,S=c(_);f({type:x,request:S,chunk:A})},f=function(v){var x=v.type,_=v.chunk,A=v.request,S=_||{},D=S.mediaInfo,k=S.start,L=D||{},I=L.type,P=Dn(A,t),M=P.requestStart,V=P.requestResponseStart,K=P.requestResponseEnd,U=P.requestBytesLoaded,j=P.requestResponseHeaders,J=P.requestMediaDuration,F=P.requestHostname,O=P.requestUrl,z=P.requestId,q=mc(I,t),Z=q.currentLevel,ce=q.renditionWidth,ue=q.renditionHeight,fe=q.renditionBitrate;a("requestcompleted",{request_event_type:x,request_start:M,request_response_start:V,request_response_end:K,request_bytes_loaded:U,request_type:I,request_response_headers:j,request_hostname:F,request_id:z,request_url:O,request_media_start_time:k,request_media_duration:J,request_current_level:Z,request_labeled_bitrate:fe,request_video_width:ce,request_video_height:ue})};n>=4?t.on("mediaFragmentLoaded",f):t.on("mediaFragmentLoaded",h);var m={video:void 0,audio:void 0,totalBitrate:void 0},g=function(){if(m.video&&typeof m.video.bitrate=="number"){if(!(m.video.width&&m.video.height)){s.warn("have bitrate info for video but missing width/height");return}var v=m.video.bitrate;if(m.audio&&typeof m.audio.bitrate=="number"&&(v+=m.audio.bitrate),v!==m.totalBitrate)return m.totalBitrate=v,{video_source_bitrate:v,video_source_height:m.video.height,video_source_width:m.video.width,video_source_codec:gc(m.video.codec)}}},p=function(v,x,_){if(typeof v.newQuality!="number"){s.warn("missing evt.newQuality in qualityChangeRendered event",v);return}var A=v.mediaType;if(A==="audio"||A==="video"){var S=t.getBitrateInfoListFor(A).find(function(k){var L=k.qualityIndex;return L===v.newQuality});if(!(S&&typeof S.bitrate=="number")){s.warn("missing bitrate info for ".concat(A));return}m[A]=br(ai({},S),{codec:t.getCurrentTrackFor(A).codec});var D=g();D&&a("renditionchange",D)}};t.on("qualityChangeRendered",p);var T=function(v){var x=v.request,_=v.mediaType;x=x||{},a("requestcanceled",{request_event_type:x.type+"_"+x.action,request_url:x.url,request_type:_,request_hostname:Me(x.url)})};t.on("fragmentLoadingAbandoned",T);var E=function(v){var x=v.error,_,A,S=(x==null||(_=x.data)===null||_===void 0?void 0:_.request)||{},D=(x==null||(A=x.data)===null||A===void 0?void 0:A.response)||{};(x==null?void 0:x.code)===27&&a("requestfailed",{request_error:S.type+"_"+S.action,request_url:S.url,request_hostname:Me(S.url),request_type:S.mediaType,request_error_code:D.status,request_error_text:D.statusText});var k="".concat(S!=null&&S.url?"url: ".concat(S.url,`
`):"")+"".concat(D!=null&&D.status||D!=null&&D.statusText?"response: ".concat(D==null?void 0:D.status,", ").concat(D==null?void 0:D.statusText,`
`):"");a("error",{player_error_code:x==null?void 0:x.code,player_error_message:x==null?void 0:x.message,player_error_context:k})};t.on("error",E),t._stopMuxMonitor=function(){t.off("manifestLoaded",o),t.off("initFragmentLoaded",d),t.off("mediaFragmentLoaded",f),t.off("qualityChangeRendered",p),t.off("error",E),t.off("fragmentLoadingAbandoned",T),delete t._stopMuxMonitor}},Tc=function(r){r&&typeof r._stopMuxMonitor=="function"&&r._stopMuxMonitor()},In=0,vc=function(){"use strict";function r(){ye(this,r),C(this,"_listeners",void 0)}return He(r,[{key:"on",value:function(e,t,i){return t._eventEmitterGuid=t._eventEmitterGuid||++In,this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],i&&(t=t.bind(i)),this._listeners[e].push(t),t}},{key:"off",value:function(e,t){var i=this._listeners&&this._listeners[e];i&&i.forEach(function(s,n){s._eventEmitterGuid===t._eventEmitterGuid&&i.splice(n,1)})}},{key:"one",value:function(e,t,i){var s=this;t._eventEmitterGuid=t._eventEmitterGuid||++In;var n=function(){s.off(e,n),t.apply(i||this,arguments)};n._eventEmitterGuid=t._eventEmitterGuid,this.on(e,n)}},{key:"emit",value:function(e,t){var i=this;if(this._listeners){t=t||{};var s=this._listeners["before*"]||[],n=this._listeners[e]||[],a=this._listeners["after"+e]||[],o=function(l,c){l=l.slice(),l.forEach(function(u){u.call(i,{type:e},c)})};o(s,t),o(n,t),o(a,t)}}}]),r}(),Ec=vc,mr=Oe(Ge()),xc=function(){"use strict";function r(e){var t=this;ye(this,r),C(this,"_playbackHeartbeatInterval",void 0),C(this,"_playheadShouldBeProgressing",void 0),C(this,"pm",void 0),this.pm=e,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,e.on("playing",function(){t._playheadShouldBeProgressing=!0}),e.on("play",this._startPlaybackHeartbeatInterval.bind(this)),e.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),e.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),e.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("seeked",function(){e.data.player_is_paused?t._stopPlaybackHeartbeatInterval():t._startPlaybackHeartbeatInterval()}),e.on("timeupdate",function(){t._playbackHeartbeatInterval!==null&&e.emit("playbackheartbeat")}),e.on("devicesleep",function(i,s){t._playbackHeartbeatInterval!==null&&(mr.default.clearInterval(t._playbackHeartbeatInterval),e.emit("playbackheartbeatend",{viewer_time:s.viewer_time}),t._playbackHeartbeatInterval=null)})}return He(r,[{key:"_startPlaybackHeartbeatInterval",value:function(){var e=this;this._playbackHeartbeatInterval===null&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=mr.default.setInterval(function(){e.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,this._playbackHeartbeatInterval!==null&&(mr.default.clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),r}(),_c=xc,Sc=function r(e){"use strict";var t=this;ye(this,r),C(this,"viewErrored",void 0),e.on("viewinit",function(){t.viewErrored=!1}),e.on("error",function(i,s){try{var n=e.errorTranslator({player_error_code:s.player_error_code,player_error_message:s.player_error_message,player_error_context:s.player_error_context,player_error_severity:s.player_error_severity,player_error_business_exception:s.player_error_business_exception});n&&(e.data.player_error_code=n.player_error_code||s.player_error_code,e.data.player_error_message=n.player_error_message||s.player_error_message,e.data.player_error_context=n.player_error_context||s.player_error_context,e.data.player_error_severity=n.player_error_severity||s.player_error_severity,e.data.player_error_business_exception=n.player_error_business_exception||s.player_error_business_exception,t.viewErrored=!0)}catch(a){e.mux.log.warn("Exception in error translator callback.",a),t.viewErrored=!0}}),e.on("aftererror",function(){var i,s,n,a,o;(i=e.data)===null||i===void 0||delete i.player_error_code,(s=e.data)===null||s===void 0||delete s.player_error_message,(n=e.data)===null||n===void 0||delete n.player_error_context,(a=e.data)===null||a===void 0||delete a.player_error_severity,(o=e.data)===null||o===void 0||delete o.player_error_business_exception})},bc=Sc,Ac=function(){"use strict";function r(e){ye(this,r),C(this,"_watchTimeTrackerLastCheckedTime",void 0),C(this,"pm",void 0),this.pm=e,this._watchTimeTrackerLastCheckedTime=null,e.on("playbackheartbeat",this._updateWatchTime.bind(this)),e.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return He(r,[{key:"_updateWatchTime",value:function(e,t){var i=t.viewer_time;this._watchTimeTrackerLastCheckedTime===null&&(this._watchTimeTrackerLastCheckedTime=i),de(this.pm.data,"view_watch_time",i-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=i}},{key:"_clearWatchTimeState",value:function(e,t){this._updateWatchTime(e,t),this._watchTimeTrackerLastCheckedTime=null}}]),r}(),Rc=Ac,Lc=function(){"use strict";function r(e){var t=this;ye(this,r),C(this,"_playbackTimeTrackerLastPlayheadPosition",void 0),C(this,"_lastTime",void 0),C(this,"_isAdPlaying",void 0),C(this,"_callbackUpdatePlaybackTime",void 0),C(this,"pm",void 0),this.pm=e,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=me.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null;var i=this._startPlaybackTimeTracking.bind(this);e.on("playing",i),e.on("adplaying",i),e.on("seeked",i);var s=this._stopPlaybackTimeTracking.bind(this);e.on("playbackheartbeatend",s),e.on("seeking",s),e.on("adplaying",function(){t._isAdPlaying=!0}),e.on("adended",function(){t._isAdPlaying=!1}),e.on("adpause",function(){t._isAdPlaying=!1}),e.on("adbreakstart",function(){t._isAdPlaying=!1}),e.on("adbreakend",function(){t._isAdPlaying=!1}),e.on("adplay",function(){t._isAdPlaying=!1}),e.on("viewinit",function(){t._playbackTimeTrackerLastPlayheadPosition=-1,t._lastTime=me.now(),t._isAdPlaying=!1,t._callbackUpdatePlaybackTime=null})}return He(r,[{key:"_startPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime===null&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var e=this.pm.data.player_playhead_time,t=me.now(),i=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&e>this._playbackTimeTrackerLastPlayheadPosition?i=e-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(i=t-this._lastTime),i>0&&i<=1e3&&de(this.pm.data,"view_content_playback_time",i),this._playbackTimeTrackerLastPlayheadPosition=e,this._lastTime=t}}]),r}(),Dc=Lc,Ic=function(){"use strict";function r(e){ye(this,r),C(this,"pm",void 0),this.pm=e;var t=this._updatePlayheadTime.bind(this);e.on("playbackheartbeat",t),e.on("playbackheartbeatend",t),e.on("timeupdate",t),e.on("destroy",function(){e.off("timeupdate",t)})}return He(r,[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=typeof this.pm.data.view_max_playhead_position=="undefined"?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(e,t){var i=this,s=function(){i.pm.currentFragmentPDT&&i.pm.currentFragmentStart&&(i.pm.data.player_program_time=i.pm.currentFragmentPDT+i.pm.data.player_playhead_time-i.pm.currentFragmentStart)};if(t&&t.player_playhead_time)this.pm.data.player_playhead_time=t.player_playhead_time,s(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var n=this.pm.getPlayheadTime();typeof n!="undefined"&&(this.pm.data.player_playhead_time=n,s(),this._updateMaxPlayheadPosition())}}}]),r}(),wc=Ic,wn=5*60*1e3,kc=function r(e){"use strict";if(ye(this,r),!e.disableRebufferTracking){var t,i=function(n,a){s(a),t=void 0},s=function(n){if(t){var a=n.viewer_time-t;de(e.data,"view_rebuffer_duration",a),t=n.viewer_time,e.data.view_rebuffer_duration>wn&&(e.emit("viewend"),e.send("viewend"),e.mux.log.warn("Ending view after rebuffering for longer than ".concat(wn,"ms, future events will be ignored unless a programchange or videochange occurs.")))}e.data.view_watch_time>=0&&e.data.view_rebuffer_count>0&&(e.data.view_rebuffer_frequency=e.data.view_rebuffer_count/e.data.view_watch_time,e.data.view_rebuffer_percentage=e.data.view_rebuffer_duration/e.data.view_watch_time)};e.on("playbackheartbeat",function(n,a){return s(a)}),e.on("rebufferstart",function(n,a){t||(de(e.data,"view_rebuffer_count",1),t=a.viewer_time,e.one("rebufferend",i))}),e.on("viewinit",function(){t=void 0,e.off("rebufferend",i)})}},Cc=kc,Pc=function(){"use strict";function r(e){var t=this;ye(this,r),C(this,"_lastCheckedTime",void 0),C(this,"_lastPlayheadTime",void 0),C(this,"_lastPlayheadTimeUpdatedTime",void 0),C(this,"_rebuffering",void 0),C(this,"pm",void 0),this.pm=e,!(e.disableRebufferTracking||e.disablePlayheadRebufferTracking)&&(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,e.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),e.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),e.on("seeking",function(){t._cleanupRebufferTracker(null,{viewer_time:me.now()})}))}return He(r,[{key:"_checkIfRebuffering",value:function(e,t){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing){this._cleanupRebufferTracker(e,t);return}if(this._lastCheckedTime===null){this._prepareRebufferTrackerState(t.viewer_time);return}if(this._lastPlayheadTime!==this.pm.data.player_playhead_time){this._cleanupRebufferTracker(e,t,!0);return}var i=t.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.sustainedRebufferThreshold=="number"&&i>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=t.viewer_time}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(e){this._lastCheckedTime=e,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=e}},{key:"_cleanupRebufferTracker",value:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:t.viewer_time});else{if(this._lastCheckedTime===null)return;var s=this.pm.data.player_playhead_time-this._lastPlayheadTime,n=t.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.minimumRebufferDuration=="number"&&s>0&&n-s>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+n-s}))}i?this._prepareRebufferTrackerState(t.viewer_time):this._clearRebufferTrackerState()}}]),r}(),Mc=Pc,Oc=function(){"use strict";function r(e){var t=this;ye(this,r),C(this,"NAVIGATION_START",void 0),C(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){var i=e.data,s=i.view_id;if(!i.view_program_changed){var n=function(a,o){var l=o.viewer_time;(a.type==="playing"&&typeof e.data.view_time_to_first_frame=="undefined"||a.type==="adplaying"&&(typeof e.data.view_time_to_first_frame=="undefined"||t._inPrerollPosition()))&&t.calculateTimeToFirstFrame(l||me.now(),s)};e.one("playing",n),e.one("adplaying",n),e.one("viewend",function(){e.off("playing",n),e.off("adplaying",n)})}})}return He(r,[{key:"_inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time=="undefined"||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(e,t){t===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:e}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.NAVIGATION_START))}}]),r}(),Nc=Oc,Fc=function r(e){"use strict";var t=this;ye(this,r),C(this,"_lastPlayerHeight",void 0),C(this,"_lastPlayerWidth",void 0),C(this,"_lastPlayheadPosition",void 0),C(this,"_lastSourceHeight",void 0),C(this,"_lastSourceWidth",void 0),e.on("viewinit",function(){t._lastPlayheadPosition=-1});var i=["pause","rebufferstart","seeking","error","adbreakstart","hb"],s=["playing","hb"];i.forEach(function(n){e.on(n,function(){if(t._lastPlayheadPosition>=0&&e.data.player_playhead_time>=0&&t._lastPlayerWidth>=0&&t._lastSourceWidth>0&&t._lastPlayerHeight>=0&&t._lastSourceHeight>0){var a=e.data.player_playhead_time-t._lastPlayheadPosition;if(a<0){t._lastPlayheadPosition=-1;return}var o=Math.min(t._lastPlayerWidth/t._lastSourceWidth,t._lastPlayerHeight/t._lastSourceHeight),l=Math.max(0,o-1),c=Math.max(0,1-o);e.data.view_max_upscale_percentage=Math.max(e.data.view_max_upscale_percentage||0,l),e.data.view_max_downscale_percentage=Math.max(e.data.view_max_downscale_percentage||0,c),de(e.data,"view_total_content_playback_time",a),de(e.data,"view_total_upscaling",l*a),de(e.data,"view_total_downscaling",c*a)}t._lastPlayheadPosition=-1})}),s.forEach(function(n){e.on(n,function(){t._lastPlayheadPosition=e.data.player_playhead_time,t._lastPlayerWidth=e.data.player_width,t._lastPlayerHeight=e.data.player_height,t._lastSourceWidth=e.data.video_source_width,t._lastSourceHeight=e.data.video_source_height})})},Uc=Fc,Bc=2e3,$c=function r(e){"use strict";var t=this;ye(this,r),C(this,"isSeeking",void 0),this.isSeeking=!1;var i=-1,s=function(){var n=me.now(),a=(e.data.viewer_time||n)-(i||n);de(e.data,"view_seek_duration",a),e.data.view_max_seek_time=Math.max(e.data.view_max_seek_time||0,a),t.isSeeking=!1,i=-1};e.on("seeking",function(n,a){if(Object.assign(e.data,a),t.isSeeking&&a.viewer_time-i<=Bc){i=a.viewer_time;return}t.isSeeking&&s(),t.isSeeking=!0,i=a.viewer_time,de(e.data,"view_seek_count",1),e.send("seeking")}),e.on("seeked",function(){s()}),e.on("viewend",function(){t.isSeeking&&(s(),e.send("seeked")),t.isSeeking=!1,i=-1})},Gc=$c,kn=function(r,e){r.push(e),r.sort(function(t,i){return t.viewer_time-i.viewer_time})},Hc=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],Kc=function(){"use strict";function r(e){var t=this;ye(this,r),C(this,"_adHasPlayed",void 0),C(this,"_adRequests",void 0),C(this,"_adResponses",void 0),C(this,"_currentAdRequestNumber",void 0),C(this,"_currentAdResponseNumber",void 0),C(this,"_prerollPlayTime",void 0),C(this,"_wouldBeNewAdPlay",void 0),C(this,"isAdBreak",void 0),C(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){t.isAdBreak=!1,t._currentAdRequestNumber=0,t._currentAdResponseNumber=0,t._adRequests=[],t._adResponses=[],t._adHasPlayed=!1,t._wouldBeNewAdPlay=!0,t._prerollPlayTime=void 0}),Hc.forEach(function(s){return e.on(s,t._updateAdData.bind(t))});var i=function(){t.isAdBreak=!1};e.on("adbreakstart",function(){t.isAdBreak=!0}),e.on("play",i),e.on("playing",i),e.on("viewend",i),e.on("adrequest",function(s,n){n=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdRequestNumber++},n),kn(t._adRequests,n),de(e.data,"view_ad_request_count"),t.inPrerollPosition()&&(e.data.view_preroll_requested=!0,t._adHasPlayed||de(e.data,"view_preroll_request_count"))}),e.on("adresponse",function(s,n){n=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdResponseNumber++},n),kn(t._adResponses,n);var a=t.findAdRequest(n.ad_request_id);a&&de(e.data,"view_ad_request_time",Math.max(0,n.viewer_time-a.viewer_time))}),e.on("adplay",function(s,n){t._adHasPlayed=!0,t._wouldBeNewAdPlay&&(t._wouldBeNewAdPlay=!1,de(e.data,"view_ad_played_count")),t.inPrerollPosition()&&!e.data.view_preroll_played&&(e.data.view_preroll_played=!0,t._adRequests.length>0&&(e.data.view_preroll_request_time=Math.max(0,n.viewer_time-t._adRequests[0].viewer_time)),e.data.view_start&&(e.data.view_startup_preroll_request_time=Math.max(0,n.viewer_time-e.data.view_start)),t._prerollPlayTime=n.viewer_time)}),e.on("adplaying",function(s,n){t.inPrerollPosition()&&typeof e.data.view_preroll_load_time=="undefined"&&typeof t._prerollPlayTime!="undefined"&&(e.data.view_preroll_load_time=n.viewer_time-t._prerollPlayTime,e.data.view_startup_preroll_load_time=n.viewer_time-t._prerollPlayTime)}),e.on("adclicked",function(s,n){t._wouldBeNewAdPlay||de(e.data,"view_ad_clicked_count")}),e.on("adskipped",function(s,n){t._wouldBeNewAdPlay||de(e.data,"view_ad_skipped_count")}),e.on("adended",function(){t._wouldBeNewAdPlay=!0}),e.on("aderror",function(){t._wouldBeNewAdPlay=!0})}return He(r,[{key:"inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time=="undefined"||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(e){for(var t=0;t<this._adRequests.length;t++)if(this._adRequests[t].ad_request_id===e)return this._adRequests[t]}},{key:"_updateAdData",value:function(e,t){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&t.ad_tag_url){var i=Xe(Ft(t.ad_tag_url),2),s=i[0],n=i[1];this.pm.data.view_preroll_ad_tag_domain=n,this.pm.data.view_preroll_ad_tag_hostname=s}if(!this.pm.data.view_preroll_ad_asset_hostname&&t.ad_asset_url){var a=Xe(Ft(t.ad_asset_url),2),o=a[0],l=a[1];this.pm.data.view_preroll_ad_asset_domain=l,this.pm.data.view_preroll_ad_asset_hostname=o}}this.pm.data.ad_asset_url=t==null?void 0:t.ad_asset_url,this.pm.data.ad_tag_url=t==null?void 0:t.ad_tag_url,this.pm.data.ad_creative_id=t==null?void 0:t.ad_creative_id,this.pm.data.ad_id=t==null?void 0:t.ad_id,this.pm.data.ad_universal_id=t==null?void 0:t.ad_universal_id}}]),r}(),Vc=Kc,Cn=Oe(Ge()),qc=function r(e){"use strict";ye(this,r);var t,i,s=function(){e.disableRebufferTracking||(de(e.data,"view_waiting_rebuffer_count",1),t=me.now(),i=Cn.default.setInterval(function(){if(t){var c=me.now();de(e.data,"view_waiting_rebuffer_duration",c-t),t=c}},250))},n=function(){e.disableRebufferTracking||t&&(de(e.data,"view_waiting_rebuffer_duration",me.now()-t),t=!1,Cn.default.clearInterval(i))},a=!1,o=function(){a=!0},l=function(){a=!1,n()};e.on("waiting",function(){a&&s()}),e.on("playing",function(){n(),o()}),e.on("pause",l),e.on("seeking",l)},Wc=qc,Yc=function r(e){"use strict";var t=this;ye(this,r),C(this,"lastWallClockTime",void 0);var i=function(){t.lastWallClockTime=me.now(),e.on("before*",s)},s=function(n){var a=me.now(),o=t.lastWallClockTime;t.lastWallClockTime=a,a-o>3e4&&(e.emit("devicesleep",{viewer_time:o}),Object.assign(e.data,{viewer_time:o}),e.send("devicesleep"),e.emit("devicewake",{viewer_time:a}),Object.assign(e.data,{viewer_time:a}),e.send("devicewake"))};e.one("playbackheartbeat",i),e.on("playbackheartbeatend",function(){e.off("before*",s),e.one("playbackheartbeat",i)})},jc=Yc,gr=Oe(Ge()),qn=function(r){return r()}(function(){var r=function(){for(var t=0,i={};t<arguments.length;t++){var s=arguments[t];for(var n in s)i[n]=s[n]}return i};function e(t){function i(s,n,a){var o;if(typeof document!="undefined"){if(arguments.length>1){if(a=r({path:"/"},i.defaults,a),typeof a.expires=="number"){var l=new Date;l.setMilliseconds(l.getMilliseconds()+a.expires*864e5),a.expires=l}try{o=JSON.stringify(n),/^[\{\[]/.test(o)&&(n=o)}catch{}return t.write?n=t.write(n,s):n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),s=encodeURIComponent(String(s)),s=s.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),s=s.replace(/[\(\)]/g,escape),document.cookie=[s,"=",n,a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}s||(o={});for(var c=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,d=0;d<c.length;d++){var h=c[d].split("="),f=h.slice(1).join("=");f.charAt(0)==='"'&&(f=f.slice(1,-1));try{var m=h[0].replace(u,decodeURIComponent);if(f=t.read?t.read(f,m):t(f,m)||f.replace(u,decodeURIComponent),this.json)try{f=JSON.parse(f)}catch{}if(s===m){o=f;break}s||(o[m]=f)}catch{}}return o}}return i.set=i,i.get=function(s){return i.call(i,s)},i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(s,n){i(s,"",r(n,{expires:-1}))},i.withConverter=e,i}return e(function(){})}),Wn="muxData",zc=function(r){return Object.entries(r).map(function(e){var t=Xe(e,2),i=t[0],s=t[1];return"".concat(i,"=").concat(s)}).join("&")},Xc=function(r){return r.split("&").reduce(function(e,t){var i=Xe(t.split("="),2),s=i[0],n=i[1],a=+n,o=n&&a==n?a:n;return e[s]=o,e},{})},Yn=function(){var r;try{r=Xc(qn.get(Wn)||"")}catch{r={}}return r},jn=function(r){try{qn.set(Wn,zc(r),{expires:365})}catch{}},Qc=function(){var r=Yn();return r.mux_viewer_id=r.mux_viewer_id||Nt(),r.msn=r.msn||Math.random(),jn(r),{mux_viewer_id:r.mux_viewer_id,mux_sample_number:r.msn}},Jc=function(){var r=Yn(),e=me.now();return r.session_start&&(r.sst=r.session_start,delete r.session_start),r.session_id&&(r.sid=r.session_id,delete r.session_id),r.session_expires&&(r.sex=r.session_expires,delete r.session_expires),(!r.sex||r.sex<e)&&(r.sid=Nt(),r.sst=e),r.sex=e+25*60*1e3,jn(r),{session_id:r.sid,session_start:r.sst,session_expires:r.sex}};function Zc(r,e){var t=e.beaconCollectionDomain,i=e.beaconDomain;if(t)return"https://"+t;r=r||"inferred";var s=i||"litix.io";return r.match(/^[a-z0-9]+$/)?"https://"+r+"."+s:"https://img.litix.io/a.gif"}var eu=Oe(Ge()),zn=function(){var r;switch(Xn()){case"cellular":r="cellular";break;case"ethernet":r="wired";break;case"wifi":r="wifi";break;case void 0:break;default:r="other"}return r},Xn=function(){var r=eu.default.navigator,e=r&&(r.connection||r.mozConnection||r.webkitConnection);return e&&e.type};zn.getConnectionFromAPI=Xn;var tu=zn,iu={a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"},ru=Qn(iu),su={ad:"ad",ag:"aggregate",ap:"api",al:"application",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",br:"break",bw:"browser",by:"bytes",bz:"business",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ck:"clicked",cl:"canceled",cn:"config",co:"count",ce:"counter",cp:"complete",cr:"creative",ct:"content",cu:"current",cx:"connection",cz:"context",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",ep:"experiments",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ez:"exception",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pr:"preload",ps:"position",pt:"part",py:"property",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",st:"start",su:"startup",sv:"server",sw:"software",sy:"severity",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"},Pn=Qn(su);function Qn(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[r[t]]=t);return e}function xr(r){var e={},t={};return Object.keys(r).forEach(function(i){var s=!1;if(r.hasOwnProperty(i)&&r[i]!==void 0){var n=i.split("_"),a=n[0],o=ru[a];o||(oe.info("Data key word `"+n[0]+"` not expected in "+i),o=a+"_"),n.splice(1).forEach(function(l){l==="url"&&(s=!0),Pn[l]?o+=Pn[l]:Number(l)&&Math.floor(Number(l))===Number(l)?o+=l:(oe.info("Data key word `"+l+"` not expected in "+i),o+="_"+l+"_")}),s?t[o]=r[i]:e[o]=r[i]}}),Object.assign(e,t)}var ct=Oe(Ge()),nu={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},au=56*1024,ou=["hb","requestcompleted","requestfailed","requestcanceled"],lu="https://img.litix.io",Qe=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._beaconUrl=r||lu,this._eventQueue=[],this._postInFlight=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},nu,e)};Qe.prototype.queueEvent=function(r,e){var t=Object.assign({},e);return this._eventQueue.length<=this._options.maxQueueLength||r==="eventrateexceeded"?(this._eventQueue.push(t),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength):!1};Qe.prototype.flushEvents=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(r&&this._eventQueue.length===1){this._eventQueue.pop();return}this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending()};Qe.prototype.destroy=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.destroyed=!0,r?this._clearBeaconQueue():this.flushEvents(),ct.default.clearTimeout(this._sendTimeout)};Qe.prototype._clearBeaconQueue=function(){var r=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,e=this._eventQueue.slice(r);r>0&&Object.assign(e[e.length-1],xr({mux_view_message:"event queue truncated"}));var t=this._createPayload(e);Jn(this._beaconUrl,t,!0,function(){})};Qe.prototype._sendBeaconQueue=function(){var r=this;if(!this._postInFlight){var e=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var t=this._createPayload(e),i=me.now();Jn(this._beaconUrl,t,!1,function(s,n){n?(r._eventQueue=e.concat(r._eventQueue),r._failureCount+=1,oe.info("Error sending beacon: "+n)):r._failureCount=0,r._roundTripTime=me.now()-i,r._postInFlight=!1})}};Qe.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var r=Math.pow(2,this._failureCount-1);return r=r*Math.random(),(1+r)*this._options.baseTimeBetweenBeacons};Qe.prototype._startBeaconSending=function(){var r=this;ct.default.clearTimeout(this._sendTimeout),!this.destroyed&&(this._sendTimeout=ct.default.setTimeout(function(){r._eventQueue.length&&r._sendBeaconQueue(),r._startBeaconSending()},this._getNextBeaconTime()))};Qe.prototype._createPayload=function(r){var e=this,t={transmission_timestamp:Math.round(me.now())};this._roundTripTime&&(t.rtt_ms=Math.round(this._roundTripTime));var i,s,n,a=function(){i=JSON.stringify({metadata:t,events:s||r}),n=i.length/1024},o=function(){return n<=e._options.maxPayloadKBSize};return a(),o()||(oe.info("Payload size is too big ("+n+" kb). Removing unnecessary events."),s=r.filter(function(l){return ou.indexOf(l.e)===-1}),a()),o()||(oe.info("Payload size still too big ("+n+" kb). Cropping fields.."),s.forEach(function(l){for(var c in l){var u=l[c],d=50*1024;typeof u=="string"&&u.length>d&&(l[c]=u.substring(0,d))}}),a()),i};var cu=function(r){return r.length<=au},Jn=function(r,e,t,i){if(t&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(r,e)){i();return}if(ct.default.fetch){ct.default.fetch(r,{method:"POST",body:e,headers:{"Content-Type":"text/plain"},keepalive:cu(e)}).then(function(n){return i(null,n.ok?null:"Error")}).catch(function(n){return i(null,n)});return}if(ct.default.XMLHttpRequest){var s=new ct.default.XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===4)return i(null,s.status!==200?"error":void 0)},s.open("POST",r),s.setRequestHeader("Content-Type","text/plain"),s.send(e);return}i()},uu=Qe,du=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id","player_error_code","player_error_message","player_error_context","player_error_severity","player_error_business_exception"],hu=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],fu=["ad_id","ad_creative_id","ad_universal_id"],mu=["viewstart","error","ended","viewend"],gu=10*60*1e3,pu=function(){"use strict";function r(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ye(this,r);var s,n,a,o,l,c,u,d,h,f,m,g;C(this,"mux",void 0),C(this,"envKey",void 0),C(this,"options",void 0),C(this,"eventQueue",void 0),C(this,"sampleRate",void 0),C(this,"disableCookies",void 0),C(this,"respectDoNotTrack",void 0),C(this,"previousBeaconData",void 0),C(this,"lastEventTime",void 0),C(this,"rateLimited",void 0),C(this,"pageLevelData",void 0),C(this,"viewerData",void 0),this.mux=e,this.envKey=t,this.options=i,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.eventQueue=new uu(Zc(this.envKey,this.options));var p;this.sampleRate=(p=this.options.sampleRate)!==null&&p!==void 0?p:1;var T;this.disableCookies=(T=this.options.disableCookies)!==null&&T!==void 0?T:!1;var E;this.respectDoNotTrack=(E=this.options.respectDoNotTrack)!==null&&E!==void 0?E:!1,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:(s=this.options.platform)===null||s===void 0?void 0:s.name,viewer_application_version:(n=this.options.platform)===null||n===void 0?void 0:n.version,viewer_application_engine:(a=this.options.platform)===null||a===void 0?void 0:a.layout,viewer_device_name:(o=this.options.platform)===null||o===void 0?void 0:o.product,viewer_device_category:"",viewer_device_manufacturer:(l=this.options.platform)===null||l===void 0?void 0:l.manufacturer,viewer_os_family:(u=this.options.platform)===null||u===void 0||(c=u.os)===null||c===void 0?void 0:c.family,viewer_os_architecture:(h=this.options.platform)===null||h===void 0||(d=h.os)===null||d===void 0?void 0:d.architecture,viewer_os_version:(m=this.options.platform)===null||m===void 0||(f=m.os)===null||f===void 0?void 0:f.version,viewer_connection_type:tu(),page_url:gr.default===null||gr.default===void 0||(g=gr.default.location)===null||g===void 0?void 0:g.href},this.viewerData=this.disableCookies?{}:Qc()}return He(r,[{key:"send",value:function(e,t){if(!(!e||!(t!=null&&t.view_id))){if(this.respectDoNotTrack&&vr())return oe.info("Not sending `"+e+"` because Do Not Track is enabled");if(!t||typeof t!="object")return oe.error("A data object was expected in send() but was not provided");var i=this.disableCookies?{}:Jc(),s=br(ai({},this.pageLevelData,t,i,this.viewerData),{event:e,env_key:this.envKey});s.user_id&&(s.viewer_user_id=s.user_id,delete s.user_id);var n,a=((n=s.mux_sample_number)!==null&&n!==void 0?n:0)>=this.sampleRate,o=this._deduplicateBeaconData(e,s),l=xr(o);if(this.lastEventTime=this.mux.utils.now(),a)return oe.info("Not sending event due to sample rate restriction",e,s,l);if(this.envKey||oe.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",e,s,l),!this.rateLimited){if(oe.info("Sending event",e,s,l),this.rateLimited=!this.eventQueue.queueEvent(e,l),this.mux.WINDOW_UNLOADING&&e==="viewend")this.eventQueue.destroy(!0);else if(this.mux.WINDOW_HIDDEN&&e==="hb"?this.eventQueue.flushEvents(!0):mu.indexOf(e)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return s.event="eventrateexceeded",l=xr(s),this.eventQueue.queueEvent(s.event,l),oe.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(e,t){var i=this,s={},n=t.view_id;if(n==="-1"||e==="viewstart"||e==="viewend"||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=gu)s=ai({},t),n&&(this.previousBeaconData=s),n&&e==="viewend"&&(this.previousBeaconData=null);else{var a=e.indexOf("request")===0;Object.entries(t).forEach(function(o){var l=Xe(o,2),c=l[0],u=l[1];i.previousBeaconData&&(u!==i.previousBeaconData[c]||du.indexOf(c)>-1||i.objectHasChanged(a,c,u,i.previousBeaconData[c])||i.eventRequiresKey(e,c))&&(s[c]=u,i.previousBeaconData[c]=u)})}return s}},{key:"objectHasChanged",value:function(e,t,i,s){return!e||t.indexOf("request_")!==0?!1:t==="request_response_headers"||typeof i!="object"||typeof s!="object"?!0:Object.keys(i||{}).length!==Object.keys(s||{}).length}},{key:"eventRequiresKey",value:function(e,t){return!!(e==="renditionchange"&&t.indexOf("video_source_")===0||fu.includes(t)&&hu.includes(e))}}]),r}(),yu=function r(e){"use strict";ye(this,r);var t=0,i=0,s=0,n=0,a=0,o=0,l=0,c=function(h,f){var m=f.request_start,g=f.request_response_start,p=f.request_response_end,T=f.request_bytes_loaded;n++;var E,v;if(g?(E=g-(m!=null?m:0),v=(p!=null?p:0)-g):v=(p!=null?p:0)-(m!=null?m:0),v>0&&T&&T>0){var x=T/v*8e3;a++,i+=T,s+=v,e.data.view_min_request_throughput=Math.min(e.data.view_min_request_throughput||1/0,x),e.data.view_average_request_throughput=i/s*8e3,e.data.view_request_count=n,E>0&&(t+=E,e.data.view_max_request_latency=Math.max(e.data.view_max_request_latency||0,E),e.data.view_average_request_latency=t/a)}},u=function(h,f){n++,o++,e.data.view_request_count=n,e.data.view_request_failed_count=o},d=function(h,f){n++,l++,e.data.view_request_count=n,e.data.view_request_canceled_count=l};e.on("requestcompleted",c),e.on("requestfailed",u),e.on("requestcanceled",d)},Tu=yu,vu=60*60*1e3,Eu=function r(e){"use strict";var t=this;ye(this,r),C(this,"_lastEventTime",void 0),e.on("before*",function(i,s){var n=s.viewer_time,a=me.now(),o=t._lastEventTime;if(t._lastEventTime=a,o&&a-o>vu){var l=Object.keys(e.data).reduce(function(c,u){return u.indexOf("video_")===0?Object.assign(c,C({},u,e.data[u])):c},{});e.mux.log.info("Received event after at least an hour inactivity, creating a new view"),e.emit("viewinit",Object.assign({viewer_time:n},l)),e.playbackHeartbeat._playheadShouldBeProgressing&&i.type!=="play"&&i.type!=="adbreakstart"&&(e.emit("play",{viewer_time:n}),i.type!=="playing"&&e.emit("playing",{viewer_time:n}))}})},xu=Eu,_u=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],Su=new Set(["requestcompleted","requestfailed","requestcanceled"]),bu=function(r){"use strict";rc(t,r);var e=ac(t);function t(i,s,n){ye(this,t);var a;a=e.call(this),C(W(a),"DOM_CONTENT_LOADED_EVENT_END",void 0),C(W(a),"NAVIGATION_START",void 0),C(W(a),"_destroyed",void 0),C(W(a),"_heartBeatTimeout",void 0),C(W(a),"adTracker",void 0),C(W(a),"dashjs",void 0),C(W(a),"data",void 0),C(W(a),"disablePlayheadRebufferTracking",void 0),C(W(a),"disableRebufferTracking",void 0),C(W(a),"errorTracker",void 0),C(W(a),"errorTranslator",void 0),C(W(a),"getAdData",void 0),C(W(a),"getPlayheadTime",void 0),C(W(a),"getStateData",void 0),C(W(a),"hlsjs",void 0),C(W(a),"id",void 0),C(W(a),"longResumeTracker",void 0),C(W(a),"minimumRebufferDuration",void 0),C(W(a),"mux",void 0),C(W(a),"oldEmit",void 0),C(W(a),"playbackEventDispatcher",void 0),C(W(a),"playbackHeartbeat",void 0),C(W(a),"playbackHeartbeatTime",void 0),C(W(a),"playheadTime",void 0),C(W(a),"seekingTracker",void 0),C(W(a),"sustainedRebufferThreshold",void 0),C(W(a),"watchTimeTracker",void 0),C(W(a),"currentFragmentPDT",void 0),C(W(a),"currentFragmentStart",void 0),a.DOM_CONTENT_LOADED_EVENT_END=ni.domContentLoadedEventEnd(),a.NAVIGATION_START=ni.navigationStart();var o={debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(f){return f}};a.mux=i,a.id=s,n!=null&&n.beaconDomain&&a.mux.log.warn("The `beaconDomain` setting has been deprecated in favor of `beaconCollectionDomain`. Please change your integration to use `beaconCollectionDomain` instead of `beaconDomain`."),n=Object.assign(o,n),n.data=n.data||{},n.data.property_key&&(n.data.env_key=n.data.property_key,delete n.data.property_key),oe.level=n.debug?lt.DEBUG:lt.WARN,a.getPlayheadTime=n.getPlayheadTime,a.getStateData=n.getStateData||function(){return{}},a.getAdData=n.getAdData||function(){},a.minimumRebufferDuration=n.minimumRebufferDuration,a.sustainedRebufferThreshold=n.sustainedRebufferThreshold,a.playbackHeartbeatTime=n.playbackHeartbeatTime,a.disableRebufferTracking=n.disableRebufferTracking,a.disableRebufferTracking&&a.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),a.disablePlayheadRebufferTracking=n.disablePlayheadRebufferTracking,a.errorTranslator=n.errorTranslator,a.playbackEventDispatcher=new pu(i,n.data.env_key,n),a.data={player_instance_id:Nt(),mux_sample_rate:n.sampleRate,beacon_domain:n.beaconCollectionDomain||n.beaconDomain},a.data.view_sequence_number=1,a.data.player_sequence_number=1,a.oldEmit=a.emit,a.emit=function(f,m){m=Object.assign({viewer_time:this.mux.utils.now()},m),this.oldEmit(f,m)};var l=function(){typeof this.data.view_start=="undefined"&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}.bind(W(a));a.on("viewinit",function(f,m){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,m),this._initializeViewData(),this.one("play",l),this.one("adbreakstart",l)});var c=function(f){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",f)}.bind(W(a));if(a.on("videochange",function(f,m){c(m)}),a.on("programchange",function(f,m){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),c(Object.assign(m,{view_program_changed:!0})),l(),this.emit("play"),this.emit("playing")}),a.on("fragmentchange",function(f,m){this.currentFragmentPDT=m.currentFragmentPDT,this.currentFragmentStart=m.currentFragmentStart}),a.on("destroy",a.destroy),typeof window!="undefined"&&typeof window.addEventListener=="function"&&typeof window.removeEventListener=="function"){var u=function(){var f=typeof a.data.view_start!="undefined";a.mux.WINDOW_HIDDEN=document.visibilityState==="hidden",f&&a.mux.WINDOW_HIDDEN&&(a.data.player_is_paused||a.emit("hb"))};window.addEventListener("visibilitychange",u,!1);var d=function(f){f.persisted||a.destroy()};window.addEventListener("pagehide",d,!1),a.on("destroy",function(){window.removeEventListener("visibilitychange",u),window.removeEventListener("pagehide",d)})}a.on("playerready",function(f,m){Object.assign(this.data,m)}),_u.forEach(function(f){a.on(f,function(m,g){f.indexOf("ad")!==0&&this._updateStateData(),Object.assign(this.data,g),this._sanitizeData()}),a.on("after"+f,function(){(f!=="error"||this.errorTracker.viewErrored)&&this.send(f)})}),a.on("viewend",function(f,m){Object.assign(a.data,m)});var h=function(f){var m=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=m-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time};return a.one("playerready",h),a.longResumeTracker=new xu(W(a)),a.errorTracker=new bc(W(a)),new jc(W(a)),a.seekingTracker=new Gc(W(a)),a.playheadTime=new wc(W(a)),a.playbackHeartbeat=new _c(W(a)),new Uc(W(a)),a.watchTimeTracker=new Rc(W(a)),new Dc(W(a)),a.adTracker=new Vc(W(a)),new Mc(W(a)),new Cc(W(a)),new Nc(W(a)),new Wc(W(a)),new Tu(W(a)),n.hlsjs&&a.addHLSJS(n),n.dashjs&&a.addDashJS(n),a.emit("viewinit",n.data),a}return He(t,[{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,typeof this.data.view_start!="undefined"&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(i){if(this.data.view_id){var s=Object.assign({},this.data),n=["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"];if(s.video_source_is_live===void 0&&(s.player_source_duration===1/0||s.video_source_duration===1/0?s.video_source_is_live=!0:(s.player_source_duration>0||s.video_source_duration>0)&&(s.video_source_is_live=!1)),s.video_source_is_live||n.forEach(function(c){s[c]=void 0}),s.video_source_url=s.video_source_url||s.player_source_url,s.video_source_url){var a=Xe(Ft(s.video_source_url),2),o=a[0],l=a[1];s.video_source_domain=l,s.video_source_hostname=o}delete s.ad_request_id,this.playbackEventDispatcher.send(i,s),this.data.view_sequence_number++,this.data.player_sequence_number++,Su.has(i)||this._restartHeartBeat(),i==="viewend"&&delete this.data.view_id}}},{key:"_updateStateData",value:function(){Object.assign(this.data,this.getStateData()),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var i=this,s=["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"];s.forEach(function(a){var o=parseInt(i.data[a],10);i.data[a]=isNaN(o)?void 0:o});var n=["player_source_url","video_source_url"];n.forEach(function(a){if(i.data[a]){var o=i.data[a].toLowerCase();(o.indexOf("data:")===0||o.indexOf("blob:")===0)&&(i.data[a]="MSE style URL")}})}},{key:"_resetVideoData",value:function(){var i=this;Object.keys(this.data).forEach(function(s){s.indexOf("video_")===0&&delete i.data[s]})}},{key:"_resetViewData",value:function(){var i=this;Object.keys(this.data).forEach(function(s){s.indexOf("view_")===0&&delete i.data[s]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(){delete this.data.player_error_code,delete this.data.player_error_message,delete this.data.player_error_context,delete this.data.player_error_severity,delete this.data.player_error_business_exception}},{key:"_initializeViewData",value:function(){var i=this,s=this.data.view_id=Nt(),n=function(){s===i.data.view_id&&de(i.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",n):n()}},{key:"_restartHeartBeat",value:function(){var i=this;window.clearTimeout(this._heartBeatTimeout),this._heartBeatTimeout=window.setTimeout(function(){i.data.player_is_paused||i.emit("hb")},1e4)}},{key:"addHLSJS",value:function(i){if(!i.hlsjs){this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.");return}if(this.hlsjs){this.mux.log.warn("An instance of HLS.js is already being monitored for this player.");return}this.hlsjs=i.hlsjs,hc(this.mux,this.id,i.hlsjs,{},i.Hls||window.Hls)}},{key:"removeHLSJS",value:function(){this.hlsjs&&(fc(this.hlsjs),this.hlsjs=void 0)}},{key:"addDashJS",value:function(i){if(!i.dashjs){this.mux.log.warn("You must pass a valid dashjs instance in order to track it.");return}if(this.dashjs){this.mux.log.warn("An instance of Dash.js is already being monitored for this player.");return}this.dashjs=i.dashjs,yc(this.mux,this.id,i.dashjs)}},{key:"removeDashJS",value:function(){this.dashjs&&(Tc(this.dashjs),this.dashjs=void 0)}}]),t}(Ec),Au=bu;Sr();var Pt=Oe(Yl());function Ru(){return Pt.default&&!!(Pt.default.fullscreenElement||Pt.default.webkitFullscreenElement||Pt.default.mozFullScreenElement||Pt.default.msFullscreenElement)}var Lu=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],Du={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};function Iu(r,e,t){var i=Xe(Tr(e),3),s=i[0],n=i[1],a=i[2],o=r.log,l=r.utils.getComputedStyle,c=r.utils.secondsToMs,u={automaticErrorTracking:!0};if(s){if(a!=="video"&&a!=="audio")return o.error("The element of `"+n+"` was not a media element.")}else return o.error("No element was found with the `"+n+"` query selector.");s.mux&&(s.mux.destroy(),delete s.mux,o.warn("Already monitoring this video element, replacing existing event listeners")),t=Object.assign(u,t),t.data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:r.VERSION},t.data),t.getPlayheadTime=function(){return c(s.currentTime)},t.getStateData=function(){var h,f=this.hlsjs&&this.hlsjs.url,m=this.dashjs&&_r(this.dashjs.getSource==="function")&&this.dashjs.getSource(),g={player_is_paused:s.paused,player_playhead_time:c(s.currentTime),player_width:parseInt(l(s,"width")),player_height:parseInt(l(s,"height")),player_autoplay_on:s.autoplay,player_preload_on:s.preload,player_language_code:s.lang,player_is_fullscreen:Ru(),video_poster_url:s.poster,video_source_url:f||m||s.currentSrc,video_source_duration:c(s.duration),video_source_height:s.videoHeight,video_source_width:s.videoWidth,view_dropped_frame_count:s==null||(h=s.getVideoPlaybackQuality)===null||h===void 0?void 0:h.call(s).droppedVideoFrames},p=t.getPlayheadTime();if(s.getStartDate&&p>0){var T=s.getStartDate();if(T&&typeof T.getTime=="function"&&T.getTime()){var E=T.getTime();if(g.player_program_time=E+p,s.seekable.length>0){var v=E+s.seekable.end(s.seekable.length-1);g.player_live_edge_program_time=v}}}return g},s.mux=s.mux||{},s.mux.deleted=!1,s.mux.emit=function(h,f){r.emit(n,h,f)};var d=function(){o.error("The monitor for this video element has already been destroyed.")};s.mux.destroy=function(){Object.keys(s.mux.listeners).forEach(function(h){s.removeEventListener(h,s.mux.listeners[h],!1)}),delete s.mux.listeners,s.mux.destroy=d,s.mux.swapElement=d,s.mux.emit=d,s.mux.addHLSJS=d,s.mux.addDashJS=d,s.mux.removeHLSJS=d,s.mux.removeDashJS=d,s.mux.deleted=!0,r.emit(n,"destroy")},s.mux.swapElement=function(h){var f=Xe(Tr(h),3),m=f[0],g=f[1],p=f[2];if(m){if(p!=="video"&&p!=="audio")return r.log.error("The element of `"+g+"` was not a media element.")}else return r.log.error("No element was found with the `"+g+"` query selector.");m.muxId=s.muxId,delete s.muxId,m.mux=m.mux||{},m.mux.listeners=Object.assign({},s.mux.listeners),delete s.mux.listeners,Object.keys(m.mux.listeners).forEach(function(T){s.removeEventListener(T,m.mux.listeners[T],!1),m.addEventListener(T,m.mux.listeners[T],!1)}),m.mux.swapElement=s.mux.swapElement,m.mux.destroy=s.mux.destroy,delete s.mux,s=m},s.mux.addHLSJS=function(h){r.addHLSJS(n,h)},s.mux.addDashJS=function(h){r.addDashJS(n,h)},s.mux.removeHLSJS=function(){r.removeHLSJS(n)},s.mux.removeDashJS=function(){r.removeDashJS(n)},r.init(n,t),r.emit(n,"playerready"),s.paused||(r.emit(n,"play"),s.readyState>2&&r.emit(n,"playing")),s.mux.listeners={},Lu.forEach(function(h){h==="error"&&!t.automaticErrorTracking||(s.mux.listeners[h]=function(){var f={};if(h==="error"){if(!s.error||s.error.code===1)return;f.player_error_code=s.error.code,f.player_error_message=Du[s.error.code]||s.error.message}r.emit(n,h,f)},s.addEventListener(h,s.mux.listeners[h],!1))})}function wu(r,e,t,i){var s=i;if(r&&typeof r[e]=="function")try{s=r[e].apply(r,t)}catch(n){oe.info("safeCall error",n)}return s}var Ot=Oe(Ge()),Tt;Ot.default&&Ot.default.WeakMap&&(Tt=new WeakMap);function ku(r,e){if(!r||!e||!Ot.default||typeof Ot.default.getComputedStyle!="function")return"";var t;return Tt&&Tt.has(r)&&(t=Tt.get(r)),t||(t=Ot.default.getComputedStyle(r,null),Tt&&Tt.set(r,t)),t.getPropertyValue(e)}function Cu(r){return Math.floor(r*1e3)}var at={TARGET_DURATION:"#EXT-X-TARGETDURATION",PART_INF:"#EXT-X-PART-INF",SERVER_CONTROL:"#EXT-X-SERVER-CONTROL",INF:"#EXTINF",PROGRAM_DATE_TIME:"#EXT-X-PROGRAM-DATE-TIME",VERSION:"#EXT-X-VERSION",SESSION_DATA:"#EXT-X-SESSION-DATA"},li=function(r){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(r),this.manifest};li.prototype.process=function(r){var e;for(this.buffer+=r,e=this.buffer.indexOf(`
`);e>-1;e=this.buffer.indexOf(`
`))this.processLine(this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)};li.prototype.processLine=function(r){var e=r.indexOf(":"),t=Nu(r,e),i=t[0],s=t.length===2?Rr(t[1]):void 0;if(i[0]!=="#")this.currentUri.uri=i,this.manifest.segments.push(this.currentUri),this.manifest.targetDuration&&!("duration"in this.currentUri)&&(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(i){case at.TARGET_DURATION:{if(!isFinite(s)||s<0)return;this.manifest.targetDuration=s,this.setHoldBack();break}case at.PART_INF:{pr(this.manifest,t),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break}case at.SERVER_CONTROL:{pr(this.manifest,t),this.setHoldBack();break}case at.INF:{s===0?this.currentUri.duration=.01:s>0&&(this.currentUri.duration=s);break}case at.PROGRAM_DATE_TIME:{var n=s,a=new Date(n);this.manifest.dateTimeString||(this.manifest.dateTimeString=n,this.manifest.dateTimeObject=a),this.currentUri.dateTimeString=n,this.currentUri.dateTimeObject=a;break}case at.VERSION:{pr(this.manifest,t);break}case at.SESSION_DATA:{var o=Fu(t[1]),l=Vn(o);Object.assign(this.manifest.sessionData,l)}}};li.prototype.setHoldBack=function(){var r=this.manifest,e=r.serverControl,t=r.targetDuration,i=r.partTargetDuration;if(e){var s="holdBack",n="partHoldBack",a=t&&t*3,o=i&&i*2;t&&!e.hasOwnProperty(s)&&(e[s]=a),a&&e[s]<a&&(e[s]=a),i&&!e.hasOwnProperty(n)&&(e[n]=i*3),i&&e[n]<o&&(e[n]=o)}};var pr=function(r,e){var t=Zn(e[0].replace("#EXT-X-","")),i;Ou(e[1])?(i={},i=Object.assign(Mu(e[1]),i)):i=Rr(e[1]),r[t]=i},Zn=function(r){return r.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},Rr=function(r){if(r.toLowerCase()==="yes"||r.toLowerCase()==="no")return r.toLowerCase()==="yes";var e=r.indexOf(":")!==-1?r:parseFloat(r);return isNaN(e)?r:e},Pu=function(r){var e={},t=r.split("=");if(t.length>1){var i=Zn(t[0]);e[i]=Rr(t[1])}return e},Mu=function(r){for(var e=r.split(","),t={},i=0;e.length>i;i++){var s=e[i],n=Pu(s);t=Object.assign(n,t)}return t},Ou=function(r){return r.indexOf("=")>-1},Nu=function(r,e){return e===-1?[r]:[r.substring(0,e),r.substring(e+1)]},Fu=function(r){var e={};if(r){var t=r.search(","),i=r.slice(0,t),s=r.slice(t+1),n=[i,s];return n.forEach(function(a,o){for(var l=a.replace(/['"]+/g,"").split("="),c=0;c<l.length;c++)l[c]==="DATA-ID"&&(e["DATA-ID"]=l[1-c]),l[c]==="VALUE"&&(e.VALUE=l[1-c])}),{data:e}}},Uu=li,Bu={safeCall:wu,safeIncrement:de,getComputedStyle:ku,secondsToMs:Cu,assign:Object.assign,headersStringToObject:Ar,cdnHeadersToRequestId:oi,extractHostnameAndDomain:Ft,extractHostname:Me,manifestParser:Uu,generateShortID:Hn,generateUUID:Nt,now:me.now},$u=Bu,Gu={PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled"},Hu=Gu,Ku="mux-embed",Vu="5.3.1",qu="2.1",ke={},tt=function(r){var e=arguments;typeof r=="string"?tt.hasOwnProperty(r)?Mt.default.setTimeout(function(){e=Array.prototype.splice.call(e,1),tt[r].apply(null,e)},0):oe.warn("`"+r+"` is an unknown task"):typeof r=="function"?Mt.default.setTimeout(function(){r(tt)},0):oe.warn("`"+r+"` is invalid.")},Wu={loaded:me.now(),NAME:Ku,VERSION:Vu,API_VERSION:qu,PLAYER_TRACKED:!1,monitor:function(r,e){return Iu(tt,r,e)},destroyMonitor:function(r){var e=Xe(Tr(r),1),t=e[0];t&&t.mux&&typeof t.mux.destroy=="function"?t.mux.destroy():oe.error("A video element monitor for `"+r+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(r,e){var t=ot(r);ke[t]?ke[t].addHLSJS(e):oe.error("A monitor for `"+t+"` has not been initialized.")},addDashJS:function(r,e){var t=ot(r);ke[t]?ke[t].addDashJS(e):oe.error("A monitor for `"+t+"` has not been initialized.")},removeHLSJS:function(r){var e=ot(r);ke[e]?ke[e].removeHLSJS():oe.error("A monitor for `"+e+"` has not been initialized.")},removeDashJS:function(r){var e=ot(r);ke[e]?ke[e].removeDashJS():oe.error("A monitor for `"+e+"` has not been initialized.")},init:function(r,e){vr()&&e&&e.respectDoNotTrack&&oe.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var t=ot(r);ke[t]=new Au(tt,t,e)},emit:function(r,e,t){var i=ot(r);ke[i]?(ke[i].emit(e,t),e==="destroy"&&delete ke[i]):oe.error("A monitor for `"+i+"` has not been initialized.")},checkDoNotTrack:vr,log:oe,utils:$u,events:Hu,WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(tt,Wu);typeof Mt.default!="undefined"&&typeof Mt.default.addEventListener=="function"&&Mt.default.addEventListener("pagehide",function(r){r.persisted||(tt.WINDOW_UNLOADING=!0)},!1);var ci=tt;function Yu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var za={exports:{}};(function(r,e){(function(t){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,n=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,c,u){if(u=u||{},l=l.trim(),c=c.trim(),!c){if(!u.alwaysNormalize)return l;var d=o.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=o.normalizePath(d.path),o.buildURLFromParts(d)}var h=o.parseURL(c);if(!h)throw new Error("Error trying to parse relative URL.");if(h.scheme)return u.alwaysNormalize?(h.path=o.normalizePath(h.path),o.buildURLFromParts(h)):c;var f=o.parseURL(l);if(!f)throw new Error("Error trying to parse base URL.");if(!f.netLoc&&f.path&&f.path[0]!=="/"){var m=s.exec(f.path);f.netLoc=m[1],f.path=m[2]}f.netLoc&&!f.path&&(f.path="/");var g={scheme:f.scheme,netLoc:h.netLoc,path:null,params:h.params,query:h.query,fragment:h.fragment};if(!h.netLoc&&(g.netLoc=f.netLoc,h.path[0]!=="/"))if(!h.path)g.path=f.path,h.params||(g.params=f.params,h.query||(g.query=f.query));else{var p=f.path,T=p.substring(0,p.lastIndexOf("/")+1)+h.path;g.path=o.normalizePath(T)}return g.path===null&&(g.path=u.alwaysNormalize?o.normalizePath(h.path):h.path),o.buildURLFromParts(g)},parseURL:function(l){var c=i.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(n,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};r.exports=o})()})(za);var tn=za.exports;function ea(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,i)}return t}function xe(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ea(Object(t),!0).forEach(function(i){Xu(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ea(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function ju(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function zu(r){var e=ju(r,"string");return typeof e=="symbol"?e:String(e)}function Xu(r,e,t){return e=zu(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function he(){return he=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},he.apply(this,arguments)}var N=Number.isFinite||function(r){return typeof r=="number"&&isFinite(r)},Qu=Number.isSafeInteger||function(r){return typeof r=="number"&&Math.abs(r)<=Ju},Ju=Number.MAX_SAFE_INTEGER||9007199254740991,y=function(r){return r.MEDIA_ATTACHING="hlsMediaAttaching",r.MEDIA_ATTACHED="hlsMediaAttached",r.MEDIA_DETACHING="hlsMediaDetaching",r.MEDIA_DETACHED="hlsMediaDetached",r.BUFFER_RESET="hlsBufferReset",r.BUFFER_CODECS="hlsBufferCodecs",r.BUFFER_CREATED="hlsBufferCreated",r.BUFFER_APPENDING="hlsBufferAppending",r.BUFFER_APPENDED="hlsBufferAppended",r.BUFFER_EOS="hlsBufferEos",r.BUFFER_FLUSHING="hlsBufferFlushing",r.BUFFER_FLUSHED="hlsBufferFlushed",r.MANIFEST_LOADING="hlsManifestLoading",r.MANIFEST_LOADED="hlsManifestLoaded",r.MANIFEST_PARSED="hlsManifestParsed",r.LEVEL_SWITCHING="hlsLevelSwitching",r.LEVEL_SWITCHED="hlsLevelSwitched",r.LEVEL_LOADING="hlsLevelLoading",r.LEVEL_LOADED="hlsLevelLoaded",r.LEVEL_UPDATED="hlsLevelUpdated",r.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",r.LEVELS_UPDATED="hlsLevelsUpdated",r.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",r.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",r.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",r.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",r.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",r.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",r.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",r.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",r.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",r.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",r.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",r.CUES_PARSED="hlsCuesParsed",r.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",r.INIT_PTS_FOUND="hlsInitPtsFound",r.FRAG_LOADING="hlsFragLoading",r.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",r.FRAG_LOADED="hlsFragLoaded",r.FRAG_DECRYPTED="hlsFragDecrypted",r.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",r.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",r.FRAG_PARSING_METADATA="hlsFragParsingMetadata",r.FRAG_PARSED="hlsFragParsed",r.FRAG_BUFFERED="hlsFragBuffered",r.FRAG_CHANGED="hlsFragChanged",r.FPS_DROP="hlsFpsDrop",r.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",r.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",r.ERROR="hlsError",r.DESTROYING="hlsDestroying",r.KEY_LOADING="hlsKeyLoading",r.KEY_LOADED="hlsKeyLoaded",r.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",r.BACK_BUFFER_REACHED="hlsBackBufferReached",r.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",r}({}),G=function(r){return r.NETWORK_ERROR="networkError",r.MEDIA_ERROR="mediaError",r.KEY_SYSTEM_ERROR="keySystemError",r.MUX_ERROR="muxError",r.OTHER_ERROR="otherError",r}({}),R=function(r){return r.KEY_SYSTEM_NO_KE